/*  This is the final completed code for our robot.
    Final Task: Currently working on cleaning up, commenting, and adding print statements to the code.
    Date: 11/9/22
    Author:Abigail Doyle
*/

//All the libraries used for the robot for work
#include <Bump_Switch.h>
#include <Encoder.h>
#include <GP2Y0A21_Sensor.h>
#include <QTRSensors.h>
#include <Romi_Motor_Power.h>
#include <RSLK_Pins.h>      //Robot pin library
#include <SimpleRSLK.h>     //Robot library
#include "PS2X_lib.h"       //Playstation controller library
#include <Servo.h>          //Gripper library
#include <TinyIRremote.h>   //IR library

//PS2 controller bluetooth dongle pins
#define PS2_DAT       14    //P1.7 = brown wire
#define PS2_CMD       15    //P1.6 = orange wire
#define PS2_SEL       34    //P2.3 = yellow wire (attention)
#define PS2_CLK       35    //P6.7 = blue wire
#define PS2X_DEBUG          //
#define PS2X_COM_DEBUG      //

//All the cases used in switch(STATE)
#define MOVE 1    //The move case
#define AUTO 2    //The auto case
#define SONG 3    //The song case

#define MS 1000                 //Variable for changing the milliseconds to seconds
#define pressures   false       //Not using pressure sensors on controller
#define rumble      false       //Not using rumble on controller
#define IR_TRX_PIN 17           //
#define STR_HELPER(x) #x        //
#define STR(x) STR_HELPER(x)    //

//Speed variables
uint16_t normalSpeed = 25;  //Sets normal speed variable to 20
uint16_t fastSpeed = 33;    //Sets normal speed variable to 33
uint16_t turnSpeed = 40;    //Sets normal speed variable to 40
//Line following variables
uint16_t sensorVal[LS_NUM_SENSORS];
uint16_t sensorCalVal[LS_NUM_SENSORS];
uint16_t sensorMaxVal[LS_NUM_SENSORS];
uint16_t sensorMinVal[LS_NUM_SENSORS];
uint8_t lineMode = 0;
uint8_t lineColor;
uint32_t linePos;

int xVal, yVal;       //Variables for x-values and y-values
int STATE = IDLE;     //Starts the robot in the IDLE case
int sharppin = 23;    //
int stopDistance = 5; //
int rightsensval;     //
int leftsensval;      //
int linePosition = 0; //
int photores = 33;    //
int led = 2;          //LED pin = 7
int light = 0;        //Light value = 0
int Health, Weapon;   //Health and Weapons variables

bool isCalibrationComplete = false;   //Sets the calibration to false when the program starts.

PS2X ps2x;        //PS2 Controller Class and object
Servo gripper;    //Declares Gripper as the servo object
IRData IRHlP;     //Health Pack
IRData IRWnP;     //Weapons Pack
IRsend sendIR;    //

//Fortnite Buzzer Constants
int buzzerPin = -1;         // buzzer pin is not assigned to anything specific until setup, just set to 0
int noteLength = 0;         // noteLength assigned to default value, isn't used
int restLength = 0;         // restLength assigned to default value, isn't used
bool testingBuzzer = false; // testingBuzzer assigned to default value, false
float noteSpeed = 0.125;    // speed of the notes/rests. 1 being normal tempo, 2 being twice as slow, and 0.5 being twice as fast

void setup() {
  Serial1.begin(57600);  //Sets the baud rate to read and print to the serial monitor.
  gripper.attach(SRV_0);        //Initializes the gripper servo
  pinMode(sharppin, INPUT);       //
  setupLed(RED_LED);              //
  clearMinMax(sensorMinVal, sensorMaxVal);      //
  pinMode(led, OUTPUT);           //
  pinMode(photores, INPUT);       //
  setupRSLK();        //Sets up the DC motor pins (aka the wheel pins)
  ps2x.config_gamepad(PS2_CLK, PS2_CMD, PS2_SEL, PS2_DAT, pressures, rumble);   //Sets up pins and settings for the PS Controller
  delayMicroseconds(1000 * MS);       //Delay for a full second
  sendIR.begin(IR_TRX_PIN, true, GREEN_LED);    //
  setBuzzerPin(37);           //Buzzer pin
  if (buzzerPin == -1) {      // test to make sure buzzer pin is initially assigned
    Serial1.println("Error: Buzzer Pin Assignment Failed");
  }
}

//Repeats endlessly until robot is turned off or loses power.
void loop() {
  ps2x.read_gamepad();      //Constantly reads the Playstation controller buttons
//If calibration isn't complete, then it runs the floor calibration, then goes into the MOVE state.
  if (isCalibrationComplete == false) {
    floorCalibration();
    isCalibrationComplete = true;
    STATE = MOVE;
  }
  switch (STATE) {
    case MOVE:
      movement();
      break;
    case AUTO:
      autonomousState();
      break;
    case SONG:
      playSong();
      break;
    default:
      break;
  }
}

//Completes floor calibration
void floorCalibration() {
  delay(2000);
  String btnMsg = "Push left button on Launchpad to begin calibration.\n";
  btnMsg += "Make sure the robot is on the floor away from the line.\n";
  delay(1000);
  Serial1.println("Running floor calibration...");
//Calibration code
  setMotorDirection(BOTH_MOTORS, MOTOR_DIR_FORWARD); //Set both motors direction forward
  enableMotor(BOTH_MOTORS);         //Enable both motors
  setMotorSpeed(BOTH_MOTORS, 20);   //Sets both motors speed to 20
  for (int x = 0; x < 100; x++) {
    readLineSensor(sensorVal);
    setSensorMinMax(sensorVal, sensorMinVal, sensorMaxVal);
    readCalLineSensor(sensorVal, sensorCalVal, sensorMinVal, sensorMaxVal, 0);
    linePosition = getLinePosition(sensorCalVal, lineMode);
  }
  disableMotor(BOTH_MOTORS);  //Disables both motors
  Serial1.println("Calibration complete");
  delay(1000);
  enableMotor(BOTH_MOTORS);
  STATE = MOVE;
}

//This function reads the joystick values and makes the robot move.
void movement() {
  delayMicroseconds(50 * MS);
  xVal = ps2x.Analog(PSS_RX);           //Assigns the variable xVal, to the right X joystick values
  xVal = map(xVal, 128, 255, 0, 20);    //Changes the xVal from 0-255 to 0-40
  yVal = ps2x.Analog(PSS_LY);           //Assigns the variable yVal, to the left Y joystick values
  yVal = map(yVal, 127, 255, 0, 50);    //Changes the yVal from 0-255 to 0-40
  if (yVal < 0) {          //If the yVal is less than 0, go forward
    Serial1.println("Going Forward");
    Serial1.print("Y-Values: ");    Serial1.println(yVal);
    setMotorDirection(BOTH_MOTORS, MOTOR_DIR_FORWARD);  //Sets both motors to forward
    enableMotor(BOTH_MOTORS);   //Turns on both motors
    setMotorSpeed(BOTH_MOTORS, yVal * -1);                   //Sets motor speed to yVal.
  } else if (yVal > 0) {   //If the yVal is less than 0, go backward
    Serial1.println("Backing Up");
    Serial1.print("Y-Values: ");    Serial1.println(yVal);
    setMotorDirection(BOTH_MOTORS, MOTOR_DIR_BACKWARD); //Sets both motors to backward
    enableMotor(BOTH_MOTORS);   //Turns on both motors
    setMotorSpeed(BOTH_MOTORS, yVal);                   //Sets motor speed to yVal
  } else if (xVal > 0) {   //If the xVal is more than 0, turn right
    Serial1.println("Turning Right");
    Serial1.print("X-Values: "); Serial1.println(xVal);
    setMotorDirection(LEFT_MOTOR, MOTOR_DIR_FORWARD);   //Sets the left motor to forward
    setMotorDirection(RIGHT_MOTOR, MOTOR_DIR_BACKWARD); //Sets the right motor to backward
    enableMotor(BOTH_MOTORS);   //Turns on both motors
    setMotorSpeed(BOTH_MOTORS, xVal);                   //Sets both motors speed to xVal
  } else if (xVal < 0) {   //If the xVal is less than 0, turn left
    Serial1.println("Turning Left");
    Serial1.print("X-Values: "); Serial1.println(xVal);
    setMotorDirection(LEFT_MOTOR, MOTOR_DIR_BACKWARD);  //Sets the left motor to backward
    setMotorDirection(RIGHT_MOTOR, MOTOR_DIR_FORWARD);  //Sets the right motor to forward
    enableMotor(BOTH_MOTORS);   //Turns on both motors
    setMotorSpeed(BOTH_MOTORS, xVal * -1);                   //Sets both motors speed to xVal
  } else if (ps2x.ButtonPressed(PSB_START)) {       //If select button is pressed...
    Serial1.println("Mode = Autonomous");
    STATE = AUTO;       //Changes the state to AUTO
  } else if (ps2x.ButtonPressed(PSB_TRIANGLE)) {    //If triangle button is pressed...
    Serial1.println("Closing Claw");
    gripper.write(92);           //Closes gripper to 92 degrees
    delayMicroseconds(10 * MS);
  } else if (ps2x.ButtonPressed(PSB_SQUARE))  {     //If square button is pressed...
    Serial1.println("Opening Claw");
    gripper.write(20);           //Opens gripper to 20 degrees
    delayMicroseconds(10 * MS);
  } else if (ps2x.ButtonPressed(PSB_CIRCLE)) {
    Serial1.println("Shooting Monster...");
    IRHlP.protocol = NEC;
    IRHlP.address = 160;
    IRHlP.command = 123;
    IRHlP.isRepeat = false;
    sendIR.write(&IRHlP);
    delay(500);
  } else if (ps2x.ButtonPressed(PSB_CROSS)) {
    Serial1.println("Shooting Health or weapon pack...");
    IRWnP.protocol = NEC;
    IRWnP.address = 160;
    IRWnP.command = 143;
    IRWnP.isRepeat = false;
    sendIR.write(&IRWnP);
    delay(500);
  } else if (ps2x.ButtonPressed(PSB_SELECT)) {      //If select button is pressed...
    Serial1.println("Mode = Song");
    STATE = SONG;       //Changes the state to SONG
  } else {
    disableMotor(BOTH_MOTORS);    //Disables both of the motors if both xVal = 0
    STATE = MOVE;       //If none of the above buttons are pressed, then automatically restart the function.
  }
}

//
void autonomousState() {
//Reads the light values
  light = analogRead(photores);
  Serial1.print("Light Value: ");  Serial1.println(light);
  if (light < 150) {      //If light is <150...
    digitalWrite(led, HIGH);    //turn on the blue LED
  } else {      //If light is >150...
    digitalWrite(led, LOW);     //turn off blue LED
  }
  lineColor = LIGHT_LINE;
  readLineSensor(sensorVal);
  readCalLineSensor(sensorVal, sensorCalVal, sensorMinVal, sensorMaxVal, lineColor);
  linePos = getLinePosition(sensorCalVal, lineColor);
  enableMotor(BOTH_MOTORS);
  rightsensval = sensorCalVal[7];
  Serial1.print("Right Floor Value: ");  Serial1.print(rightsensval);
  leftsensval = sensorCalVal[0];
  Serial1.print(" || Left Floor Value: ");  Serial1.println(leftsensval);
  if (rightsensval > 20 && leftsensval > 20) {
    disableMotor(BOTH_MOTORS);
    setMotorDirection(RIGHT_MOTOR, MOTOR_DIR_FORWARD);
    setMotorDirection(LEFT_MOTOR, MOTOR_DIR_BACKWARD);
    enableMotor(BOTH_MOTORS);
    setMotorSpeed(BOTH_MOTORS, normalSpeed);
    delayMicroseconds(1200 * MS);
    setMotorDirection(BOTH_MOTORS, MOTOR_DIR_FORWARD);
    delayMicroseconds(500 * MS);
    gripper.write(20);
    delayMicroseconds(10 * MS);
    setMotorSpeed(BOTH_MOTORS, normalSpeed);
  } else if(rightsensval > 20) {
    disableMotor(BOTH_MOTORS);
    delayMicroseconds(1 * MS);
    setMotorDirection(RIGHT_MOTOR, MOTOR_DIR_BACKWARD);
    setMotorDirection(LEFT_MOTOR, MOTOR_DIR_FORWARD);
    enableMotor(BOTH_MOTORS);
    setMotorSpeed(BOTH_MOTORS, normalSpeed);
    delayMicroseconds(20 * MS);
    disableMotor(BOTH_MOTORS);
  } else if(leftsensval > 20) {
    disableMotor(BOTH_MOTORS);
    delayMicroseconds(1 * MS);
    setMotorDirection(RIGHT_MOTOR, MOTOR_DIR_FORWARD);
    setMotorDirection(LEFT_MOTOR, MOTOR_DIR_BACKWARD);
    enableMotor(BOTH_MOTORS);
    setMotorSpeed(BOTH_MOTORS, normalSpeed);
    delayMicroseconds(20 * MS);
    disableMotor(BOTH_MOTORS);
  } else if(linePos > 0 && linePos < 3000) {
    setMotorDirection(BOTH_MOTORS, MOTOR_DIR_FORWARD);
    setMotorSpeed(LEFT_MOTOR, normalSpeed);
    setMotorSpeed(RIGHT_MOTOR, fastSpeed);
  } else if(linePos > 3500) {
    setMotorDirection(BOTH_MOTORS, MOTOR_DIR_FORWARD);
    setMotorSpeed(LEFT_MOTOR, fastSpeed);
    setMotorSpeed(RIGHT_MOTOR, normalSpeed);
  } else {
    setMotorDirection(BOTH_MOTORS, MOTOR_DIR_FORWARD);
    setMotorSpeed(BOTH_MOTORS, normalSpeed);
  } 
  if (ps2x.ButtonPressed(PSB_START)) {
    disableMotor(BOTH_MOTORS);
    Serial1.println("Mode = MOVE");
    STATE = MOVE;
  } else {
    STATE = AUTO;
  }
}

//Plays the "default dance" (from Fortnite) when select is pressed
void playSong() {
  playNote("g4", "eighth");
  restNote("eighth");
  restNote("quarter");
  playNote("g4", "quarter");
  restNote("sixteenth");
  playNote("b4", "quarter");
  restNote("sixteenth");
  playNote("c5", "half");
  restNote("sixteenth");
  playNote("c5", "quarter");
  restNote("sixteenth");
  playNote("b4", "quarter");
  restNote("whole");
  playNote("g4", "quarter");
  restNote("sixteenth");
  playNote("b4", "quarter");
  restNote("sixteenth");
  playNote("c5", "half");
  restNote("sixteenth");
  playNote("c5", "eighth");
  restNote("sixteenth");
  playNote("b4", "quarter");
  restNote("sixteenth");
  playNote("g4", "quarter");
  restNote("sixteenth");
  playNote("f4", "eighth");
  restNote("sixteenth");
  playNote("g4", "quarter");
  restNote("eighth");
  restNote("quarter");
  playNote("c5", "eighth");
  restNote("sixteenth");
  playNote("b4", "quarter");
  restNote("sixteenth");
  playNote("g4", "quarter");
  restNote("sixteenth");
  playNote("f4", "quarter");
  restNote("sixteenth");
  playNote("g4", "quarter");
  playNote("g4", "eighth");
  restNote("eighth");
  restNote("quarter");
  restNote("half");
  Serial1.print("Note Speed: ");  Serial1.println(noteSpeed);
  Serial1.println("Mode = MOVE");
  STATE = MOVE;
}

//Sets Buzzer Pin to a new pin number
void setBuzzerPin(int newBuzzerPin) {
  buzzerPin = newBuzzerPin;
  pinMode(buzzerPin, OUTPUT); // Make pin 34 an output
}

//Plays a certain type of rest note: whole, half, quarter, eighth, or sixteenth
void restNote(String restType) {
  if (restType == "whole") {
    Serial1.println("Rest Length: whole");
    restLength = (int)(4000.0 * noteSpeed);
  }
  else if (restType == "half") {
    Serial1.println("Rest Length: half");
    restLength = (int)(2000.0 * noteSpeed);
  }
  else if (restType == "quarter") {
    Serial1.println("Rest Length: quarter");
    restLength = (int)(1000.0 * noteSpeed);
  }
  else if (restType == "eighth") {
    Serial1.println("Rest Length: eighth");
    restLength = (int)(500.0 * noteSpeed);
  }
  else if (restType == "sixteenth") {
    Serial1.println("Rest Length: sixteenth");
    restLength = (int)(250.0 * noteSpeed);
  }
  else {
    Serial1.println("Invalid Rest Type");
  }
  noTone(buzzerPin);
  delayMicroseconds(restLength * MS);
}

//Plays a note between C8 and C1 (NOTE: No rests are added between notes, they must be added manually)
void playNote(String note, String noteType) {
  if (noteType == "whole") {
    Serial1.println("Note Length: whole");
    noteLength = (int)(4000.0 * noteSpeed);
  }
  else if(noteType == "half") {
    Serial1.println("Note Length: half");
    noteLength = (int)(2000.0 * noteSpeed);
  }
  else if(noteType == "quarter") {
    Serial1.println("Note Length: quarter");
    noteLength = (int)(1000.0 * noteSpeed);
  }
  else if(noteType == "eighth") {
    Serial1.println("Note Length: eighth");
    noteLength = (int)(500.0 * noteSpeed);
  }
  else if(noteType == "sixteenth") {
    Serial1.println("Note Length: sixteenth");
    noteLength = (int)(250.0 * noteSpeed);
  }
  else {
    Serial1.println("Invalid Note Type");
  }
  if (note == "c1") {
    Serial1.println("Playing c1");
    tone(buzzerPin, 33);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "d1") {
    Serial1.println("Playing d1");
    tone(buzzerPin, 37);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "e1") {
    Serial1.println("Playing e1");
    tone(buzzerPin, 41);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "f1") {
    Serial1.println("Playing f1");
    tone(buzzerPin, 44);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "g1") {
    Serial1.println("Playing g1");
    tone(buzzerPin, 49);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "a1") {
    Serial1.println("Playing a1");
    tone(buzzerPin, 55);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "b1") {
    Serial1.println("Playing b1");
    tone(buzzerPin, 62);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "c2") {
    Serial1.println("Playing c2");
    tone(buzzerPin, 65);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "d2") {
    Serial1.println("Playing d2");
    tone(buzzerPin, 73);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "e2") {
    Serial1.println("Playing e2");
    tone(buzzerPin, 82);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "f2") {
    Serial1.println("Playing f2");
    tone(buzzerPin, 87);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "g2") {
    Serial1.println("Playing g2");
    tone(buzzerPin, 98);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "a2") {
    Serial1.println("Playing a2");
    tone(buzzerPin, 110);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "b2") {
    Serial1.println("Playing b2");
    tone(buzzerPin, 124);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "c3") {
    Serial1.println("Playing c3");
    tone(buzzerPin, 131);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "d3") {
    Serial1.println("Playing d3");
    tone(buzzerPin, 147);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "e3") {
    Serial1.println("Playing e3");
    tone(buzzerPin, 165);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "f3") {
    Serial1.println("Playing f3");
    tone(buzzerPin, 175);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "g3") {
    Serial1.println("Playing g3");
    tone(buzzerPin, 196);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "a3") {
    Serial1.println("Playing a3");
    tone(buzzerPin, 220);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "b3") {
    Serial1.println("Playing b3");
    tone(buzzerPin, 247);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "c4") {
    Serial1.println("Playing c4");
    tone(buzzerPin, 262);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "d4") {
    Serial1.println("Playing d4");
    tone(buzzerPin, 294);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "e4") {
    Serial1.println("Playing e4");
    tone(buzzerPin, 330);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "f4") {
    Serial1.println("Playing f4");
    tone(buzzerPin, 349);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "g4") {
    Serial1.println("Playing g4");
    tone(buzzerPin, 392);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "a4") {
    Serial1.println("Playing a4");
    tone(buzzerPin, 440);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "b4") {
    Serial1.println("Playing b4");
    tone(buzzerPin, 494);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "c5") {
    Serial1.println("Playing c5");
    tone(buzzerPin, 523);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "d5") {
    Serial1.println("Playing d5");
    tone(buzzerPin, 587);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "e5") {
    Serial1.println("Playing e5");
    tone(buzzerPin, 659);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "f5") {
    Serial1.println("Playing f5");
    tone(buzzerPin, 699);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "g5") {
    Serial1.println("Playing g5");
    tone(buzzerPin, 784);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "a5") {
    Serial1.println("Playing a5");
    tone(buzzerPin, 880);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "b5") {
    Serial1.println("Playing b5");
    tone(buzzerPin, 988);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "c6") {
    Serial1.println("Playing c6");
    tone(buzzerPin, 1047);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "d6") {
    Serial1.println("Playing d6");
    tone(buzzerPin, 1175);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "e6") {
    Serial1.println("Playing e6");
    tone(buzzerPin, 1319);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "f6") {
    Serial1.println("Playing f6");
    tone(buzzerPin, 1397);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "g6") {
    Serial1.println("Playing g6");
    tone(buzzerPin, 1568);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "a6") {
    Serial1.println("Playing a6");
    tone(buzzerPin, 1760);
    delayMicroseconds(noteLength * MS);
  }
  else if (note == "b6") {
    Serial1.println("Playing b6");
    tone(buzzerPin, 1980);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "c7") {
    Serial1.println("Playing c7");
    tone(buzzerPin, 2093);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "d7") {
    Serial1.println("Playing d7");
    tone(buzzerPin, 2349);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "e7") {
    Serial1.println("Playing e7");
    tone(buzzerPin, 2637);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "f7") {
    Serial1.println("Playing f7");
    tone(buzzerPin, 2794);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "g7") {
    Serial1.println("Playing g7");
    tone(buzzerPin, 3136);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "a7") {
    Serial1.println("Playing a7");
    tone(buzzerPin, 3520);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "b7") {
    Serial1.println("Playing b7");
    tone(buzzerPin, 3951);
    delayMicroseconds(noteLength * MS);
  }
  else if(note == "c8") {
    Serial1.println("Playing c8");
    tone(buzzerPin, 4186);
    delayMicroseconds(noteLength * MS);
  }
}
